	<PG title="Categories" name="categories">		<SCR name="getPageID"><![CDATA[pageIcon = icon.parentNode.clip();if (rootIcon.projMode == "dev"){   // Page Wizard  pageIcon.templateData = pageIcon.extXML.toObject();  pageIcon.templateData = pageIcon.templateData.pageWizard[0];} else {  // Toolkits  myXML = new XML(extXML.firstChild.childNodes[rootIcon.getPageIndex() - pgOffset]);  pageIcon.templateData = myXML.toObject();}  rootIcon.setTitleText(templateData.learningObject[0].name);  // handle multiple page data definitions in a project if (rootIcon.projectPageIndex == undefined){     rootIcon.projectPageIndex = 0;}// check if this page has a definition for the current project index and default to 0 if notif (pageIcon.templateData.categories[rootIcon.projectPageIndex].name == undefined){  projPI = 0;} else {  projPI = rootIcon.projectPageIndex; }  //create a linear list of items from each categoryitems = new Array();catCount = 0;ddItems = "";tracking = new Array();for (i = 0; i < pageIcon.templateData.categories[projPI].category.length; i++){  catCount++;  tracking.push(new Array());  for (j = 0; j < pageIcon.templateData.categories[projPI].category[i].item.length; j++){    items.push({name: pageIcon.templateData.categories[projPI].category[i].item[j].name, cat: i});  }}//make the dragItems stringfor (i = 0; i < items.length; i++){  ddItems += 'dd' + i + '~leave~0,';}if (pageIcon.templateData.categories[projPI].buttonLabel != undefined && pageIcon.templateData.categories[projPI].buttonLabel !=""){  buttonLabel = pageIcon.templateData.categories[projPI].buttonLabel;} else {  buttonLabel = "Check Answers";}  if (pageIcon.templateData.categories[projPI].buttonWidth != undefined){  buttonWidth = pageIcon.templateData.categories[projPI].buttonWidth;} else {  buttonWidth = "120";}if (pageIcon.templateData.categories[projPI].narration != undefined){  narration = pageIcon.templateData.categories[projPI].narration;  rootIcon.broadcast('showAudio');}]]></SCR>		<DIS h="474" w="760" tabIndex="-1" id="panel" name="panel" x="20" y="20" type="ext" url="templatePath + 'common/whitePanel.swf'"><![CDATA[]]></DIS>		<DIS tabIndex="80" textColour="#333333" id="desc" name="description" x="40" y="40" w="720 - 720 / catCount" h="10" type="text"><![CDATA[{pageIcon.templateData.categories[projPI].text}]]></DIS>		<SCR name="setup"><![CDATA[if (icon.attributes.built != "true"){  icon.nextSibling.firstChild.duplicate(catCount - 1);  icon.nextSibling.nextSibling.firstChild.duplicate(items.length - 1);  icon.attributes.built = "true";}//coordinates for drawinginitY = (desc._y + desc._height < 70 ? 180 :  desc._y + desc._height + 20);catH = 444 - initY;tabManager = new Array();targetLabels = new Array();dragLabels = new Array();matchedCount = 0;lblH = 0;]]></SCR>		<DEC name="targets" repeat="all" branch="sequence" pause="0" erase="0" eraseOnExit="0">			<PG name="protoTarget">				<DIS tabIndex="-1" id="protoTarget" name="protoTarget" x="40 + 720 / catCount * icon.parentNode.index()" y="initY" w="720 / catCount - 20" h="10" type="text"><![CDATA[{'<b>' + pageIcon.templateData.categories[projPI].category[icon.parentNode.index()].name + '</b>'}]]></DIS>				<SCR name="drawTarget"><![CDATA[protoTarget.beginFill(STYLES.fillColour,100);protoTarget.lineStyle(1,STYLES.statusBarColour,100);protoTarget.drawRect(0,0,720 / catCount - 20,catH);targetLabels.push(protoTarget.txt);]]></SCR>			</PG>		</DEC>		<DEC id="labels" name="labels" repeat="all" branch="randomUnused" pause="0" erase="0" eraseOnExit="0">			<PG name="protoItem">				<SCR name="setID"><![CDATA[icon.nextSibling.attributes.id = 'dd' + (labels.repCount - 1);]]></SCR>				<DIS tabIndex="-1" textColour="#000000" name="protoItem" x="desc._x + desc._width + 20" y="desc._y" w="720 / catCount - 60" h="10" type="text"><![CDATA[{items[labels.repCount - 1].name}]]></DIS>				<SCR name="drawItem"><![CDATA[//will draw later, when we know size of biggest label...tempIc = icon.previousSibling.clip();tempIc.cat = items[labels.repCount - 1].cat;tempIc.beginFill(0xFFFFCC,100);tempIc.lineStyle(1,0x666666,100);if (tempIc._height > lblH){  lblH = tempIc._height;}tempTF = tempIc.txt.getTextFormat();tempTF.align = "center";tempIc.txt.setTextFormat(tempTF);tempIc.index = labels.repCount - 1;icon.parentNode.clip().swapDepths(items.length - icon.parentNode.index());tabManager[items.length - icon.parentNode.index()] = tempIc;dragLabels.push(tempIc);]]></SCR>			</PG>		</DEC>		<SCR name="setupInteraction"><![CDATA[//draw the labels to the largest sizefor ( i = 0; i < dragLabels.length; i++){  dragLabels[i].drawRect(0,0,720 / catCount - 60,lblH);}icon.nextSibling.firstChild.attributes.dragItems = ddItems;if (icon.attributes.built != "true"){  icon.nextSibling.firstChild.duplicate(catCount - 1);  for (i = 0; i < catCount; i++){    icon.nextSibling.childNodes[i].attributes.name = pageIcon.templateData.categories[projPI].category[i].name;  }  icon.attributes.built = "true";}matched = 0;tabManager[tabManager.length - 1].tabIndex = 101 + items.length;//make list of random orderdragLabels.randomize();dragLabels[0]._visible = true;]]></SCR>		<INT id="ddInt" name="mainInteraction" perpetual="0">			<RES name="protoTarget" type="targetArea" x="40 + 720 / catCount * icon.index()" y="initY" w="720 / catCount - 20" h="catH" dragItems="ddItems" erase="1" exit="0">				<SCR name="handleDrop"><![CDATA[catIndex = icon.parentNode.index();tracking[catIndex].push(ddInt.objectDropped);//animate to the right placenewX = 60 + 720 / catCount * icon.parentNode.index();//have to work out newY from the heights of all the existing objectstempY = 0;for (i = 0; i < tracking[icon.parentNode.index()].length - 1; i++){  tempY += tracking[catIndex][i]._height + 10;}newY = initY + targetLabels[catIndex]._height + 10 + tempY;ddInt.objectDropped.animate(newX, newY, 5, 'linearTween');matched++;tabManager[items.length - matched].tabIndex = 9999 + items.length;itemCount = 0;for (i = 0; i < tracking.length; i++){  itemCount += tracking[i].length;}if (dragLabels[itemCount]._visible == false){  dragLabels[itemCount]._visible = true;  dragLabels[itemCount].fade('in', 0.5, 'None', 'easeNone');}]]></SCR>			</RES>			<RES name="onStartDrag" type="event" eventName="onStartDrag" icon="ddInt" erase="1" exit="0">				<SCR name="swapDepths"><![CDATA[ddInt.objectDragged._parent.swapDepths(99);//remove this item from tracking if it existsfor (i = 0; i < tracking.length; i++){  if (tracking[i].findValue(ddInt.objectDragged) != -1){ //already in a list    //delete it    tracking[i].deleteAtIndex(tracking[i].findValue(ddInt.objectDragged));    tempY = 10;    for (j = 0; j < tracking[i].length; j++){      //animate to the right place      newX = tracking[i][j]._x;      if (j > 0){        tempY += tracking[i][j-1]._height + 10;      }      newY = initY + targetLabels[i]._height + tempY;      tracking[i][j].animate(newX,newY,5,'linearTween');    }    break;  }}]]></SCR>			</RES>			<RES rs="btnSubmit" w="buttonWidth" swf="templatePath + 'common/button.swf'" name="checkAnswers" type="button" x="40" y="460" label="{buttonLabel}" erase="1" exit="0">				<DIS tabIndex="-1" id="fb" name="visualFeedback" x="0" y="0" w="400" h="10" type="text"><![CDATA[]]></DIS>				<DIS id="txtFB" name="textFeedback" x="0" y="0" w="400" h="10" type="text"><![CDATA[]]></DIS>				<SCR name="check"><![CDATA[n = 0;for (i = 0; i < tracking.length; i++){  for (j = 0; j < tracking[i].length; j++){    if (tracking[i][j].cat == i){      n++;      fb.attachMovie('tick', 'tick' + n, n);      fb['tick' + n]._x = tracking[i][j]._x + tracking[i][j]._width;      fb['tick' + n]._y = tracking[i][j]._y;    }  }}if (pageIcon.templateData.categories[projPI].feedback != undefined){  txtFB._x = btnSubmit._x + parseInt(buttonWidth) + 10;  txtFB._y = btnSubmit._y;  txtFB.setText(pageIcon.templateData.categories[projPI].feedback);}]]></SCR>			</RES>		</INT>	</PG>