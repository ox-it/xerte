	<PG title="Thumbnail Viewer" name="thumbnailViewer">		<SCR name="getPageID"><![CDATA[pageIcon = icon.parentNode.clip();if (rootIcon.projMode == "dev"){   // Page Wizard  pageIcon.templateData = pageIcon.extXML.toObject();  pageIcon.templateData = pageIcon.templateData.pageWizard[0];} else {  // Toolkits  myXML = new XML(extXML.firstChild.childNodes[rootIcon.getPageIndex() - pgOffset]);  pageIcon.templateData = myXML.toObject();}  rootIcon.setTitleText(templateData.learningObject[0].name);  // handle multiple page data definitions in a project if (rootIcon.projectPageIndex == undefined){     rootIcon.projectPageIndex = 0;}// check if this page has a definition for the current project index and default to 0 if notif (pageIcon.templateData.thumbnailViewer[rootIcon.projectPageIndex].name == undefined){  projPI = 0;} else {  projPI = rootIcon.projectPageIndex; }  // set up text stringsif (pageIcon.templateData.thumbnailViewer[projPI].nextBtnTip != undefined){  nextBtnTip = pageIcon.templateData.thumbnailViewer[projPI].nextBtnTip;} else {  nextBtnTip = "Next";}if (pageIcon.templateData.thumbnailViewer[projPI].priorBtnTip != undefined){  priorBtnTip = pageIcon.templateData.thumbnailViewer[projPI].priorBtnTip;} else {  priorBtnTip = "Previous";}itemCount = pageIcon.templateData.thumbnailViewer[projPI].nestedPage.length);if (pageIcon.templateData.thumbnailViewer[projPI].narration != undefined){  narration = pageIcon.templateData.thumbnailViewer[projPI].narration;  rootIcon.broadcast('showAudio');}]]></SCR>		<DIS id="pageText" name="pageText" x="100" y="20" w="600" h="10" type="text"><![CDATA[{pageIcon.templateData.thumbnailViewer[projPI].text}]]></DIS>		<DIS id="mainImage" name="mainImage" x="20" y="20" type="ext" url="onRelease"><![CDATA[]]></DIS>		<DIS textColour="#FFFFFF" id="mainText" name="mainText" x="100" y="20" w="600" h="10" type="text"><![CDATA[]]></DIS>		<INT id="mainLoader" name="mainLoader" perpetual="1">			<RES name="onLoad" type="event" eventName="onLoad" icon="mainImage" erase="1" exit="0">				<SCR name="positionConstrain"><![CDATA[mainImage._xscale = 100;mainImage._yscale = 100;mainImage.constrain(760,400);mainImage._x = 400 - mainImage._width / 2;mainText._x = mainImage._x;mainText._y = mainImage._y;mainText.txt._width = mainImage._width;mainText.setText(ic.textString);mainText.clear();mainText.beginFill(0x000000,100);mainText.drawRect(0,0,mainImage._width, mainText.txt._height);mainText._visible = false;mainImage.dropShadow(5,45,0x999999,60);]]></SCR>			</RES>			<RES name="onRollOver" type="event" eventName="onRollOver" icon="mainImage" erase="1" exit="0">				<SCR name="showText"><![CDATA[mainText._visible = true;]]></SCR>			</RES>			<RES name="onRollOut" type="event" eventName="onRollOut" icon="mainImage" erase="1" exit="0">				<SCR name="hideText"><![CDATA[mainText._visible = false;]]></SCR>			</RES>			<RES name="onRelease" type="event" eventName="onRelease" icon="mainImage" erase="1" exit="0">				<SCR name="geturl"><![CDATA[//if original image selected link to the imageif(ic.linktarget=='Original image'){linklocation=ic.imagePath;}//if specified url selected use that urlif(ic.linktarget=='Specified URL'){linklocation=ic.link;}//only get a url if specifiedif(ic.linktarget=='Original image' | ic.linktarget=='Specified URL'){getURL(linklocation, "_blank");}else{//don't do anything}]]></SCR>			</RES>			<RES toolTip="{priorBtnTip}" swf="templatePath + 'common/leftButton.swf'" name="back" type="button" x="20" y="464" label="Back" erase="1" exit="0">				<SCR name="scroll"><![CDATA[if (thumbsDec._x<0){  thumbsDec.animate(thumbsDec._x + 400, thumbsDec._y, 10, 'linearTween');}]]></SCR>			</RES>			<RES toolTip="{nextBtnTip}" swf="templatePath + 'common/rightButton.swf'" name="next" type="button" x="760" y="464" label="Next" erase="1" exit="0">				<SCR name="scroll"><![CDATA[if (thumbsDec._x + thumbsDec._width > 400){  thumbsDec.animate(thumbsDec._x - 400, thumbsDec._y, 10, 'linearTween');}]]></SCR>			</RES>		</INT>		<SCR name="makePages"><![CDATA[if (icon.attributes.built != 'true'){  icon.nextSibling.childNodes[0].duplicate(itemCount - 1);  icon.attributes.built = 'true';}icon.parentNode.clip().beginFill(0x000000,100);icon.parentNode.clip().drawRect(0,440,800,76);thumbArray = new Array();iconArray = new Array();mainLoader.beginFill(0x000000,100);mainLoader.drawRect(0,440,55,76);mainLoader.drawRect(745,440,55,76);mainLoader.swapDepths(99);]]></SCR>		<DEC id="thumbsDec" name="thumbs" repeat="all" branch="sequence" pause="0" erase="0" eraseOnExit="0">			<PG name="protoThumbPage">				<SCR name="index"><![CDATA[currentIndex = icon.parentNode.index();]]></SCR>				<DIS id="protoThumb" name="protoThumb" x="20" y="447" type="ext" url="{pageIcon.templateData.thumbnailViewer[projPI].nestedPage[currentIndex].url}"><![CDATA[]]></DIS>				<SCR name="setup"><![CDATA[protoThumb.imagePath = expression(pageIcon.templateData.thumbnailViewer[projPI].nestedPage[currentIndex].url, engine);protoThumb.textString = pageIcon.templateData.thumbnailViewer[projPI].nestedPage[currentIndex].text;//added these to capture link options selected for each pageprotoThumb.link = pageIcon.templateData.thumbnailViewer[projPI].nestedPage[currentIndex].link;protoThumb.linktarget = pageIcon.templateData.thumbnailViewer[projPI].nestedPage[currentIndex].linktarget;iconArray.push(protoThumb);protoThumb._alpha = 70;]]></SCR>				<INT name="loader" perpetual="0">					<RES name="onLoad" type="event" eventName="onLoad" icon="protoThumb" erase="1" exit="1">						<SCR name="constrain"><![CDATA[protoThumb.constrain(60,60);protoThumb._x = 60 + 65 * currentIndex;]]></SCR>					</RES>				</INT>				<INT name="onRelease" perpetual="1">					<RES name="onRelease" type="event" eventName="onRelease" icon="protoThumb" erase="1" exit="0">						<SCR name="loadImage"><![CDATA[//get the pathif (ic != undefined){  ic._alpha = 70;} else {  pageText._visible = false;}ic = iconArray[icon.parentNode.parentNode.parentNode.index()];ic._alpha = 100;mainText.setText('');mainImage.clearFilters();mainImage.loadImage(ic.imagePath);]]></SCR>					</RES>				</INT>			</PG>		</DEC>	</PG>