	<PG title="enter page title" name="tabNavExtra">		<SCR name="getPageID"><![CDATA[pageIcon = icon.parentNode.clip();if (rootIcon.projMode == "dev"){   // Page Wizard  pageIcon.templateData = pageIcon.extXML.toObject();  pageIcon.templateData = pageIcon.templateData.pageWizard[0];} else {  // Toolkits  myXML = new XML(extXML.firstChild.childNodes[rootIcon.getPageIndex() - pgOffset]);  pageIcon.templateData = myXML.toObject();}  rootIcon.setTitleText(templateData.learningObject[0].name);  // handle multiple page data definitions in a project if (rootIcon.projectPageIndex == undefined){     rootIcon.projectPageIndex = 0;}// check if this page has a definition for the current project index and default to 0 if notif (pageIcon.templateData.tabNavExtra[rootIcon.projectPageIndex].name == undefined){  projPI = 0;} else {  projPI = rootIcon.projectPageIndex; }    pageInfo = pageIcon.templateData.tabNavExtra[projPI];]]></SCR>		<SCR name="setUpPage"><![CDATA[// creates all links & tabstopicCount = pageInfo.topic.length; // no. topic links on lefttabCount = new Array(); // no. tabs for each topicrememberTab = pageInfo.rememberTab;if (rememberTab == undefined || rememberTab == "") {  rememberTab = false;}currentTopic = 0;currentTab = 0;currentPage = 0;for (i=0; i<topicCount; i++) {  tabCount.push(pageInfo.topic[i].nestedTab.length);}framework = icon.parentNode.getChildByName('mainFW');if (icon.attributes.built != 'true'){  framework.firstChild.getChildByName('protoLink').duplicate(topicCount - 1);  for (i=0; i<topicCount; i++) {    framework.firstChild.childNodes[i].id = "topicLink" + i;  }  framework.firstChild.getChildByName('topicLinkEvents').firstChild.duplicate(topicCount - 1);  framework.getChildByName('protoTopic').duplicate(topicCount - 1);    for (i=0; i<topicCount; i++) {    framework.childNodes[i+1].getChildByName('tabs').firstChild.duplicate(tabCount[i] - 1);    framework.childNodes[i+1].getChildByName('tabs').firstChild.attributes.rs = 'tab1';    framework.childNodes[i+1].getChildByName('tabs').lastChild.previousSibling.attributes.rs = 'lastTab'; // initialise interaction fires when last tab has loaded        for (j=0; j<tabCount[i]; j++) {      itemCount = pageInfo.topic[i].nestedTab[j].nestedPage.length;      thisTab = framework.childNodes[i+1].getChildByName('tabs').childNodes[j];      if (itemCount != 1) {        framework.childNodes[i+1].getChildByName('tabs').childNodes[j].getChildByName('tabFW').firstChild.duplicate(itemCount - 1);        thisTab.getChildByName('protoCrumb').duplicate(itemCount - 1); // no. pages for each tab        thisTab.getChildByName('crumbLinkEvents').firstChild.duplicate(itemCount - 1);      } else {        thisTab.getChildByName('protoCrumb').removeNode();        thisTab.getChildByName('lines').removeNode();        thisTab.getChildByName('drawLines').removeNode();        thisTab.getChildByName('crumbLinkEvents').removeNode();      }    }  }  icon.attributes.built = 'true';}if (pageInfo.tabWidth == undefined){  tabW = 100;} else {  tabW = Number(pageInfo.tabWidth);}if (pageInfo.narration != undefined){  narration = pageInfo.narration;  rootIcon.broadcast('showAudio');}]]></SCR>		<DIS initObject="{_alpha: subPageAccess == true ? 20 : 100}" h="463" w="605" tabIndex="-1" id="panel" name="panel" x="180" y="37" type="ext" url="templatePath + 'common/whitePanel.swf'"><![CDATA[]]></DIS>		<INT name="panelLoader" perpetual="0">			<RES name="loader" type="event" eventName="onLoad" icon="panel" erase="1" exit="1">				<SCR name="loaded"><![CDATA[//continue once panel has loaded]]></SCR>			</RES>		</INT>		<DIS id="topicHighlight" name="topicHighlight" x="0" y="0" type="ext" url="FileLocation + "><![CDATA[]]></DIS>		<FW id="mainFW" name="mainFW">			<FW_ENT name="entryFrame">				<DIS name="protoLink" x="20" y="icon.index() == 0 ? panel._y : icon.previousSibling.clip()._y + icon.previousSibling.clip()._height + 10" w="140" h="10" type="text"><![CDATA[{pageInfo.topic[icon.index()].name}]]></DIS>				<INT name="topicLinkEvents" perpetual="1">					<RES name="protoEvent" type="event" eventName="onRelease" icon="icon.parentNode.parentNode.childNodes[icon.index()].clip()" erase="1" exit="0">						<SCR name="chgFWPage"><![CDATA[// change panel info and highlight topic nameif (mainFW.currentPage != icon.parentNode.index()) {  framework.firstChild.childNodes[mainFW.currentPage].clip().enabled = true;  framework.firstChild.childNodes[mainFW.currentPage].clip().setText(pageInfo.topic[mainFW.currentPage].name);  framework.firstChild.childNodes[icon.parentNode.index()].clip().setText("<b>" + pageInfo.topic[icon.parentNode.index()].name + "</b>");  framework.firstChild.childNodes[icon.parentNode.index()].clip().enabled = false;  if (rememberTab != "true") {    currentTab = 0;    currentPage = 0;  }}mainFW.gotoPage(icon.parentNode.index());topicHighlight.clear();topicHighlight.beginFill(0xFFFFFF, 60);410, 5);topicHighlight.drawRect(framework.firstChild.childNodes[mainFW.currentPage].clip()._x-5, framework.firstChild.childNodes[mainFW.currentPage].clip()._y-2, framework.firstChild.childNodes[mainFW.currentPage].clip()._width+10, framework.firstChild.childNodes[mainFW.currentPage].clip()._height+4, 5);topicHighlight.endFill();]]></SCR>					</RES>				</INT>				<SCR name="initSelection"><![CDATA[// have 1st topic highlighted initiallyframework.firstChild.childNodes[mainFW.currentPage].clip().setText("<b>" + pageInfo.topic[mainFW.currentPage].name + "</b>");framework.firstChild.childNodes[mainFW.currentPage].clip().enabled = false;topicHighlight.clear();topicHighlight.beginFill(0xFFFFFF, 60);topicHighlight.drawRect(framework.firstChild.childNodes[mainFW.currentPage].clip()._x-5, framework.firstChild.childNodes[mainFW.currentPage].clip()._y-2, framework.firstChild.childNodes[mainFW.currentPage].clip()._width+10, framework.firstChild.childNodes[mainFW.currentPage].clip()._height+4, 5);topicHighlight.endFill();]]></SCR>			</FW_ENT>			<PG name="protoTopic">				<INT id="tabs" name="tabs" perpetual="1">					<RES w="tabW" swf="templatePath + 'common/tabButton.swf'" name="protoTab" type="button" x="(icon.index() * tabW) + panel._x + 7" y="panel._y - 22" label="{pageInfo.topic[icon.findParentByName('protoTopic').index()-1].nestedTab[icon.index()].name}" erase="1" exit="0">						<DIS w="panel._width-20" textSize="10" name="protoCrumb" x="icon.index() == 0 ? panel._x + 10 : icon.previousSibling.clip()._x + icon.previousSibling.clip().getTextWidth() + 10" y="panel._y + 7" h="10" type="text"><![CDATA[{"<a>" + pageInfo.topic[icon.parentNode.parentNode.parentNode.index()-1].nestedTab[icon.parentNode.index()].nestedPage[icon.index()].name + "</a>"}]]></DIS>						<DIS id="lines" name="lines" x="0" y="0" type="ext" url="FileLocation + "><![CDATA[]]></DIS>						<SCR name="drawLines"><![CDATA[crumbClip = icon.parentNode.firstChild.clip();lines.lineStyle(1, '0x999999', 50);lines.moveTo(panel._x + 10, crumbClip._y + crumbClip._height + 5); // draw line underneath link listlines.lineTo(panel._x + panel._width - 10, crumbClip._y + crumbClip._height + 5);]]></SCR>						<INT name="crumbLinkEvents" perpetual="1">							<RES name="protoEvent" type="event" eventName="onRelease" icon="icon.findParentByName('protoTab').childNodes[icon.index()].clip()" erase="1" exit="0">								<SCR name="chgFWPage"><![CDATA[if (currentPage != icon.parentNode.index()) { // highlight this nested page title & change main text accordingly  icon.findParentByName('protoTab').childNodes[currentPage].clip().enabled = true;  icon.findParentByName('protoTab').childNodes[currentPage].clip().setText("<a>" + pageInfo.topic[currentTopic].nestedTab[currentTab].nestedPage[currentPage].name + "</a>");  currentPage = icon.parentNode.index();  icon.findParentByName('protoTab').childNodes[currentPage].clip().setText("<b>" + pageInfo.topic[currentTopic].nestedTab[currentTab].nestedPage[currentPage].name + "</b>");  icon.findParentByName('protoTab').childNodes[currentPage].clip().enabled = false;  tabFW.gotoPage(currentPage);}]]></SCR>							</RES>						</INT>						<SCR name="script"><![CDATA[btn = icon.parentNode.getMovieClip();btn.setChecked(true,true); // select tabif (currentTab != icon.parentNode.index()) {  currentPage = 0;}currentTab = icon.parentNode.index();if (subPageAccess == true){  icon.parentNode.getChildByName('panelTxt').attributes.textColour = STYLES.defaultColour;} else {  icon.parentNode.getChildByName('panelTxt').attributes.textColour = '#333333';}if (pageInfo.topic[currentTopic].nestedTab[currentTab].nestedPage.length > 1) {  icon.findParentByName('protoTab').childNodes[currentPage].clip().setText("<b>" + pageInfo.topic[currentTopic].nestedTab[currentTab].nestedPage[currentPage].name + "</b>");  icon.findParentByName('protoTab').childNodes[currentPage].clip().enabled = false; // highlight nested page title}]]></SCR>						<FW id="tabFW" name="tabFW">							<PG name="protoPage">								<SCR name="script"><![CDATA[if (pageInfo.topic[currentTopic].nestedTab[currentTab].nestedPage[currentPage].url == undefined) {  icon.parentNode.getChildByName('graphicLoader').attributes.perpetual = 1;} else {  icon.parentNode.getChildByName('graphicLoader').attributes.perpetual = 0;  if (pageInfo.topic[currentTopic].nestedTab[currentTab].nestedPage[currentPage].tip != undefined) {    icon.nextSibling.attributes.toolTip = pageInfo.topic[currentTopic].nestedTab[currentTab].nestedPage[currentPage].tip;  }}]]></SCR>								<DIS id="graphic" name="graphic" x="panel._x + 10" y="icon.parentNode.parentNode.parentNode.getChildByName('protoCrumb') == undefined ? panel._y + 10 : panel._y + 40" type="ext" url="{pageInfo.topic[currentTopic].nestedTab[currentTab].nestedPage[currentPage].url}"><![CDATA[]]></DIS>								<INT name="graphicLoader" perpetual="0">									<RES name="resizeImg" type="event" eventName="onLoad" icon="graphic" erase="1" exit="1">										<SCR name="loader"><![CDATA[graphic._xscale = 100;graphic._yscale = 100;maxW = panel._width - 20;maxH = (panel._height + panel._y - 10) - graphic._y;if (pageInfo.topic[currentTopic].nestedTab[currentTab].nestedPage[currentPage].text != undefined) {  maxH -= 50; // leaves some space for text}if (maxW < graphic._width || maxH < graphic._height) {  scaleW = (maxW / graphic._width) * 100;  scaleH = (maxH / graphic._height) * 100;  scale = scaleW;  if (scaleW > scaleH) {    scale = scaleH;  }  graphic._xscale = scale;  graphic._yscale = scale;}if (graphic._width < maxW) {  xDif = (maxW - graphic._width) / 2;  graphic._x = panel._x + xDif + 10;} else {  graphic._x = panel._x + 10;}]]></SCR>									</RES>								</INT>								<DIS scrolling="auto" id="panelTxt" name="panelTxt" x="panel._x + 10" y="graphic._height != 0 ? graphic._y + graphic._height + 10 : graphic._y" w="panel._width - 20" h="graphic._height != 0 ? (panel._height + panel._y) - (graphic._y + graphic._height + 20) : (panel._height + panel._y) - graphic._y - 10" type="text"><![CDATA[{pageInfo.topic[currentTopic].nestedTab[currentTab].nestedPage[currentPage].text}]]></DIS>							</PG>						</FW>					</RES>					<RES name="initialise" type="event" eventName="onLoad" icon="lastTab" erase="1" exit="0">						<INT name="wait" perpetual="0">							<RES name="delay" type="timeLimit" secs="0" reset="0" erase="1" exit="0">								<SCR name="showInitData"><![CDATA[if (rememberTab == "true") {  prevTabName = pageInfo.topic[currentTopic].nestedTab[currentTab].name;  prevPageName = pageInfo.topic[currentTopic].nestedTab[currentTab].nestedPage[currentPage].name;  tabMatch = 0;  pageMatch = 0;    for (i=0; i<pageInfo.topic[mainFW.currentPage].nestedTab.length; i++) {    if (prevTabName == pageInfo.topic[mainFW.currentPage].nestedTab[i].name) { // matching tab found      tabMatch = i;      for (j=0; j<pageInfo.topic[mainFW.currentPage].nestedTab[i].nestedPage.length; j++) {        if (prevPageName == pageInfo.topic[mainFW.currentPage].nestedTab[tabMatch].nestedPage[j].name) { // matching nested page found          pageMatch = j;                  break;        }      }      break;    }  }    currentTab = tabMatch;  currentPage = pageMatch;}currentTopic = mainFW.currentPage;icon.findParentByName('tabs').childNodes[currentTab].clip().swfFile.onRelease();panelTxt.setText(pageInfo.topic[currentTopic].nestedTab[currentTab].nestedPage[currentPage].text);]]></SCR>							</RES>						</INT>					</RES>				</INT>			</PG>		</FW>	</PG>