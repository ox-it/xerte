	<PG title="Mapstraction" name="Mapstraction">		<SCR name="getPageID"><![CDATA[pageIcon = icon.parentNode.clip();if (rootIcon.projMode == "dev"){   // Page Wizard  pageIcon.templateData = pageIcon.extXML.toObject();  pageIcon.templateData = pageIcon.templateData.pageWizard[0];} else {  // Toolkits  myXML = new XML(extXML.firstChild.childNodes[rootIcon.getPageIndex() - pgOffset]);  pageIcon.templateData = myXML.toObject();}  rootIcon.setTitleText(templateData.learningObject[0].name);  // handle multiple page data definitions in a project if (rootIcon.projectPageIndex == undefined){     rootIcon.projectPageIndex = 0;}// check if this page has a definition for the current project index and default to 0 if notif (pageIcon.templateData.mapstraction[rootIcon.projectPageIndex].name == undefined){  projPI = 0;} else {  projPI = rootIcon.projectPageIndex; }  if (pageIcon.templateData.mapstraction[projPI].narration != undefined){  narration = pageIcon.templateData.mapstraction[projPI].narration;  rootIcon.broadcast('showAudio');}]]></SCR>		<SCR name="Mapstraction"><![CDATA[qs = '?';qs += 'provider='+pageIcon.templateData.mapstraction[projPI].provider;qs += '&lat='+pageIcon.templateData.mapstraction[projPI].lat;qs += '&lng='+pageIcon.templateData.mapstraction[projPI].lng;qs += '&zoom='+pageIcon.templateData.mapstraction[projPI].zoom;//any overlays?if (pageIcon.templateData.mapstraction[projPI].overlay != undefined){    temp = new Array();  for (i = 0; i< pageIcon.templateData.mapstraction[projPI].overlay.length; i++){    //on the web or uploaded?    if (pageIcon.templateData.mapstraction[projPI].overlay[i].url.indexOf('FileLocation') != -1 ){     tempURL = '../' + expression(pageIcon.templateData.mapstraction[projPI].overlay[i].url, engine);     temp.push(tempURL);    } else {      tempURL = pageIcon.templateData.mapstraction[projPI].overlay[i].url;      temp.push(escape(tempURL));    }  }  qs += '&overlays=' + temp.join('|');}//flickr search for georss, if definedif (pageIcon.templateData.mapstraction[projPI].flickr != undefined){  qs += '&flickr=' + pageIcon.templateData.mapstraction[projPI].flickr;}params = new Object();params.type = 'iframe';params.id = 'popup0';params.screenSize = rootIcon.sizes.getValue();params.calcW = 95;params.calcH = 79;params.calcX = 2.5;params.calcY = 14;params.width = Stage.width;params.height = Stage.height;params.src = 'mapstraction/mapstraction.htm' + qs;params.bgColour = '#FFFFFF';params.borderColour = '#000000';callJS('makePopUp', params);popupActive = true;]]></SCR>	</PG>